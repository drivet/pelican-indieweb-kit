<div class="card">
    <div class="card-body">
        <div class="card-text">
            <header class="article-header">
                {% include 'includes/article_info_head.html' %}
            </header>
            
            {% for like in article.like_of %}
            <div class="my-2">
                Liked a <a class="u-like-of" href="{{like}}">post</a>
            </div>
            {% endfor %}
            
            {% for repost in article.repost_of %}
            <div class="my-2">
                Reposted a <a class="u-repost-of" href="{{repost}}">post</a>
            </div>
            {% endfor %}
            
            {% for reply in article.in_reply_to %}
            <div class="my-2">
                Replied to a <a class="u-in-reply-to" href="{{reply}}">post</a>
            </div>
            {% endfor %}
            
            <div class="my-2 entry-content e-content">
                {{ article.content }}
                {% for photo in article.photo %}
                {% if photo.alt %}
                <img src="{{photo.value}}" alt="{{ photo.alt | replace('\,', ',') }}"
                     class="u-photo embedded-photo"/>
                {% else %}
                <img src="{{photo.value}}" class="u-photo embedded-photo"/>
                {% endif %}
                {% endfor %}
            </div>
            {% if article.preview %}
            <div class="preview">
            {% if 'html' in article.preview %}
            <div class="rich-preview-wrapper">
                <div class="rich-preview">{{ article.preview.html|safe }}</div>   
            </div>
            {% else %}
            <div class="card-preview card">
                {% if 'image' in article.preview and article.preview.image %}
                   {% set width = article.preview['image:width'] | int %}
                   {% set height = article.preview['image:height'] | int %}
                   {% if width > 300 %}
                       <a href="{{article.preview.url}}">
                           <img class="card-img-top"
                                src="{{article.preview.image}}">
                       </a>
                       <div class="card-body">
                          <h5 class="card-title">{{article.preview.title}}</h5>
                          <p class="card-text">{{article.preview.description}}</p>
                       </div>
                   {% else %}
                       <div class="row no-gutters">
                           <div class="col-md-3">
                               <img src="{{article.preview.image}}"
                                    width="175" height="175">
                           </div>
                           <div class="col-md-9">
                               <div class="card-body">
                                   <h5 class="card-title">{{article.preview.title}}</h5>
                                   <p class="card-text">{{article.preview.description}}</p>
                               </div>
                           </div>
                       </div>
                   {% endif %}
               {% else %}
                   <div class="card-body">
                      <h5 class="card-title">{{article.preview.title}}</h5>
                      <p class="card-text">{{article.preview.description}}</p>
                   </div>
               {% endif %}
            </div>
            {% endif %}
            </div>
            {% endif %}
            {% include 'includes/article_info_foot.html' %}
        </div>
    </div>
</div>
